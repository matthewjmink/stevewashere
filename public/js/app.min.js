!function(){"use strict";angular.module("app",["app.core","app.nav","app.map","app.list"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ui.router","firebase","core.router"])}(),function(){"use strict";angular.module("core.router",["ui.router"])}(),function(){"use strict";angular.module("app.list",["app.core"])}(),function(){"use strict";angular.module("app.map",["app.core"])}(),function(){"use strict";angular.module("app.nav",["app.core"])}(),function(){"use strict";function t(){function t(t,o,a){var r=n(t,o,a);return e(r.r,r.g,r.b)}function n(t,n,e){t=6*o(t,360),n=o(n,100),e=o(e,100);var a=c.floor(t),r=t-a,i=e*(1-n),u=e*(1-r*n),l=e*(1-(1-r)*n),s=a%6,p=[e,u,i,i,l,e][s],m=[l,e,e,u,i,i][s],f=[i,i,l,e,e,u][s];return{r:255*p,g:255*m,b:255*f}}function e(t,n,e){var o=[i(u(t).toString(16)),i(u(n).toString(16)),i(u(e).toString(16))];return o.join("")}function o(t,n){a(t)&&(t="100%");var e=r(t);return t=l(n,s(0,parseFloat(t))),e&&(t=parseInt(t*n,10)/100),c.abs(t-n)<1e-6?1:t%n/parseFloat(n)}function a(t){return"string"==typeof t&&-1!==t.indexOf(".")&&1===parseFloat(t)}function r(t){return"string"==typeof t&&-1!==t.indexOf("%")}function i(t){return 1===t.length?"0"+t:""+t}var c=Math,u=c.round,l=c.min,s=c.max;c.random;return{hsvToHex:t,hsvToRgb:n,rgbToHex:e}}angular.module("app.core").factory("colorService",t)}(),function(){"use strict";function t(t){var e=void 0;t.configureStates(n(),e)}function n(){return[{state:"404",config:{url:"/404",templateUrl:"/core/404.html"}}]}angular.module("app.core").run(t),t.$inject=["routerHelper"]}(),function(){function t(t){function n(){function n(t){return{type:"FeatureCollection",metadata:{title:"Steve Mink Territory Clients",status:200,api:"1.0.0",count:t.length},features:t}}function e(t){console.log("getLocations failed: "+t)}var o=new Firebase("https://iwashere.firebaseio.com/locations"),a=t(o);return a.$loaded().then(n)["catch"](e)}return{getLocations:n}}angular.module("app.core").factory("dataservice",t),t.$inject=["$firebaseArray"]}(),function(){"use strict";function t(t,n,e){function o(t){function o(t,o){t.forEach(function(t){n.state(t.state,t.config)}),e.when("","/"),o&&!r&&(r=!0,e.otherwise(o))}function a(){return t.get()}var r=!1,i={configureStates:o,getStates:a};return i}this.$get=o,o.$inject=["$state"]}angular.module("core.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function t(t){function n(){return t.getLocations()}var e=this;e.locations=null,n().then(function(t){e.locations=t.features,console.log(e.locations)})}angular.module("app.map").controller("ListController",t),t.$inject=["dataservice"]}(),function(){"use strict";function t(t){t.configureStates(n())}function n(){return[{state:"list",config:{url:"/list",templateUrl:"/list/list.html",controller:"ListController",controllerAs:"list"}}]}angular.module("app.list").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){function n(){return t.getLocations()}function e(t){return o.locations.features.$save(o.locations.features.$getRecord(t)).then(function(t){return t})}var o=this;o.getLocations=n,o.updateLocation=e,o.loading=!0,o.locations=null,o.maxDays=365,o.now=Date.now(),o.success=null,o.timeout=null}angular.module("app.map").controller("MapController",t),t.$inject=["dataservice"]}(),function(){"use strict";function t(t,n,e){function o(o,a,r){function i(t){o.map.locations=t,o.map.map.data.addGeoJson(o.map.locations),d(),g();var n=u();n.length>0&&(n.length>1&&n.sort(h),f(n[0])),o.map.loading=!1}function c(){o.map.now=Date.now(),o.map.location.setProperty("last_checkin",o.map.now),d(),o.map.updateLocation(o.map.location.getId()).then(function(t){o.map.success=!0,o.map.timeout=e(function(){o.map.success=!1},2500),o.map.infoWindow.close()})}function u(){for(var t=o.map.locations.features,n=[],e=0;e<t.length;e++){var a=s(o.map.currentLocation.latitude,o.map.currentLocation.longitude,t[e].geometry.coordinates[1],t[e].geometry.coordinates[0]);if(5>a){var r=o.map.map.data.getFeatureById(o.map.locations.features[e].id);r.setProperty("nearbyDistance",a),n.push(r)}}return n}function l(){function t(t){o.map.currentLocation=t.coords,m()}function n(t){m()}var e={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};navigator.geolocation.getCurrentPosition(t,n,e)}function s(t,n,e,o){var a=6371,r=.5-Math.cos((e-t)*Math.PI/180)/2+Math.cos(t*Math.PI/180)*Math.cos(e*Math.PI/180)*(1-Math.cos((o-n)*Math.PI/180))/2;return 2*a*Math.asin(Math.sqrt(r))}function p(n){var e=(o.map.now-n)/864e5;if(e<o.map.maxDays){var a=120-e/o.map.maxDays*120,r=t.hsvToHex(a,100,100);return"https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=|"+r}return"https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=|FF0000"}function m(){var t={center:{lat:o.map.currentLocation.latitude,lng:o.map.currentLocation.longitude},zoom:13,mapTypeControlOptions:{mapTypeIds:[]}};o.map.map=new google.maps.Map(document.getElementById("map"),t),o.map.getLocations().then(i)}function f(t){o.map.location=t,o.map.anchor.set("position",t.j.j),o.map.infoWindow.open(o.map.map,o.map.anchor)}function g(t){o.map.map.data.addListener("click",function(t){o.map.location=t.feature,o.$apply();var n=new google.maps.MVCObject;n.set("position",t.latLng),o.map.infoWindow.open(o.map.map,n)})}function d(){o.map.map.data.setStyle(function(t){var n=t.getProperty("last_checkin"),e=o.map.getMarkerIcon(n);return{icon:e}})}function h(t,n){return t.getProperty("nearbyDistance")<n.getProperty("nearbyDistance")?-1:t.getProperty("nearbyDistance")>n.getProperty("nearbyDistance")?1:0}o.map.anchor=new google.maps.MVCObject,o.map.checkIn=c,o.map.currentLocation={latitude:42.5673029,longitude:-87.9162311},o.map.getMarkerIcon=p,o.map.infoContent=n('<div class="checkin-container"><h5>{{map.location.getProperty("name")}}</h5><p><small>Last visit: {{ map.location.getProperty("last_checkin") | date : \'short\'}}</small></p><button class="btn btn-primary btn-lg" ng-click="map.checkIn();">Steve Was Here</button></div>')(o),o.map.infoWindow=new google.maps.InfoWindow({content:o.map.infoContent[0],pixelOffset:new google.maps.Size(0,-32)}),o.map.map=null,l()}return{restrict:"EA",link:o}}angular.module("app.map").directive("map",t),t.$inject=["colorService","$compile","$timeout"]}(),function(){"use strict";function t(t){t.configureStates(n())}function n(){return[{state:"map",config:{url:"/",templateUrl:"/map/map.html",controller:"MapController",controllerAs:"map"}}]}angular.module("app.map").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,n){function e(n){return t.is(n)}var o=this;o.isActive=e}angular.module("app.nav").controller("NavController",t),t.$inject=["$state","$timeout"]}(),function(){"use strict";function t(t,n){function e(e,o){n.$on("$stateChangeSuccess",function(){t[0].body.classList.remove("menu-active")}),o.on("click",function(n){t[0].body.classList.toggle("menu-active")})}return{restrict:"A",link:e}}function n(){return{restrict:"AE",controller:"NavController",controllerAs:"nav",templateUrl:"/nav/nav.html"}}angular.module("app.nav").directive("menuToggle",t).directive("nav",n),t.$inject=["$document","$rootScope"]}();